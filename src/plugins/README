= Introduction =

Plugins are modules that are loaded at runtime to provide information about
requests and to service user actions like installing, removing and updating.
Plugins are disabled by default, and need to be enabled manually before they
are used.
This allows different distributions to pick and choose how the application
installer gathers data just by setting a single GSettings key. For instance:

 SuSE has AppStream data and also uses PackageKit. The default on SuSE would be
 to enable the 'appstream' and 'packagekit' plugins and leave the rest disabled.

 Fedora doesn't have AppStream data, so it has to make do with other local data.
 On Fedora we would enable the 'datadir-apps', 'desktop-db' and all the
 'hardcoded' plugins to get some sensible results. For Fedora, it probably also
 makes sense to write a plugin that interfaces with FAS or fedora-tagger to get
 the extra metadata for uninstalled applications.

Plugins also have a priority system where the largest number gets run first.
That means if one plugin requires some property or metadata set by another
plugin then it *must* have a priority value that is greater to ensure the
property is available.

As we are letting the distribution pick and choose what plugins are run, we need
a way to 'refine' the results. For instance, the 'packagekit' plugin returns
applications with a kind GS_APP_KIND_PACKAGE which will not be returned to the
UI for display as they are not applications.
The 'packagekit' plugin relies on other plugins like 'appstream' or 'desktopdb'
to add the required name, summary and icon data and to convert the GsApp to a
GS_APP_KIND_NORMAL.
Furthermore, the 'hardcoded-kind' plugin may override the GS_APP_KIND_NORMAL
kind to a GS_APP_KIND_SYSTEM which means the application is core cannot be
removed by the user. Core apps would be things like nautilus and totem.

As a general rule, try to make plugins as small and self-contained as possible
and remember to cache as much data as possible for speed. Memory is cheap, time
less so.

= Plugins =

In this document, applicaton properties are specified as [id] meaning the
property called 'id' and metadata (basically, random properites that we don't
want to export) are specified as {sekret-property}.
Adding and using metadata is quick as it's stored internally in a hash table,
so don't be afraid to add extra properties where it might make sense for other
plugins.

== dummy ==
Overview:	Provides some dummy data that is useful in self test programs.
Methods:	Search
		AddUpdates
		AddInstalled
		AddPopular
Requires:	<nothing>
Refines:	[id]->[name]
		[id]->[summary]

== hardcoded-kind ==
Overview:	Provides some hardcoded static core applications that cannot
		be removed.
Methods:	<nothing>
Requires:	<nothing>
Refines:	[id]->[kind]
Note:		This is based on the gnome jhbuild moduleset

== hardcoded-popular ==
Overview:	Provides some hardcoded static favourite applications.
Methods:	AddPopular
Requires:	<nothing>
Refines:	<nothing>

== hardcoded-ratings ==
Overview:	Provides some hardcoded static ratings for applications.
Methods:	<nothing>
Requires:	<nothing>
Refines:	[id]->[rating]

== packagekit ==
Overview:	Uses the system PackageKit instance to return package data.
Methods:	Search
		AddUpdates
		AddInstalled
		Install
		Remove
		Update
Requires:	{package-id}
Refines:	<nothing>
Sets:		{package-id}
		{package-name}
		{package-summary}
		{update-name}
		{update-details}

== desktopdb ==
Overview:	Uses the PackageKit desktop.db cache to map package names to
		desktop names.
Methods:	<nothing>
Requires:	<nothing>
Refines:	{package-name}->{datadir-desktop-filename}

== datadir-apps ==
Overview:	Uses the files in /usr/share/applications to provide icons and
		translations for installed applications.
Methods:	<nothing>
Requires:	<nothing>
Refines:	{datadir-desktop-filename}->[name]
		{datadir-desktop-filename}->[summary]
		{datadir-desktop-filename}->[pixbuf]
		{datadir-desktop-filename}->[id]
		{datadir-desktop-filename}->[kind]

== datadir-filename ==
Overview:	Uses the existance of a files in /usr/share/applications
		named $id.desktop to set the correct desktop filename.
		This is useful if we just have a bare [id] from something like
		AddPopular and want to get the details using 'datadir-apps'
Methods:	<nothing>
Requires:	<nothing>
Refines:	[id]->{datadir-desktop-filename}
